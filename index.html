<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Visualize time spent per move in an OGS game" />
  <link rel="stylesheet" href="https://unpkg.com/awsm.css/dist/awsm_theme_white.min.css" media="(prefers-color-scheme: no-preference), (prefers-color-scheme: light)">
  <link rel="stylesheet" href="https://unpkg.com/awsm.css/dist/awsm_theme_black.min.css" media="(prefers-color-scheme: dark)">
  <title>ogs-move-timing Bookmarklet</title>
</head>
<body>
  <main>
    <h1>ogs-move-timing</h1>
<p>Visualize time spent per move in an OGS game</p>
<h2>Installation</h2>
<p>Drag this link to your browser's bookmarks bar: <a href="javascript:void (function(){function e(e){const t=document.createElement(&quot;div&quot;);t.classList.add(&quot;mt-chart&quot;);const n=&quot;1rem&quot;,r=document.createElement(&quot;style&quot;);r.textContent=`&#92;n.mt-chart, .mt-chart * {&#92;n  box-sizing: border-box;&#92;n}&#92;n&#92;n.mt-chart {&#92;n  display: flex;&#92;n  position: relative;&#92;n  background-color: darkgray;&#92;n  min-height: 100%;&#92;n  cursor: crosshair;&#92;n  padding-inline: ${n};&#92;n&#92;n  --mt-dark-highlight: #ffd800;&#92;n  --mt-light-highlight: yellow;&#92;n}&#92;n&#92;n.mt-bar {&#92;n  flex: 1 1 100%;&#92;n  background-color: var(--mt-bar-color);&#92;n}&#92;n&#92;n.mt-bar-wrapper {&#92;n  min-height: 100%;&#92;n  position: relative;&#92;n  display: flex;&#92;n  align-items: flex-end;&#92;n  flex: 1 0 1px;&#92;n}&#92;n&#92;n.mt-bar-wrapper:hover {&#92;n  background-color: var(--mt-light-highlight);&#92;n}&#92;n&#92;n.mt-bar-wrapper:hover .mt-bar {&#92;n  background-color: var(--mt-dark-highlight);&#92;n}&#92;n&#92;n.mt-bar-wrapper::before {&#92;n  display: none;&#92;n  position: absolute;&#92;n  content: attr(data-time) &#39; on move &#39; attr(data-move);&#92;n  top: 0px;&#92;n  min-width: 10rem;&#92;n  padding: 0.2rem;&#92;n  background-color: white;&#92;n  border-radius: 5px;&#92;n  z-index: 1;&#92;n  text-align: center;&#92;n  pointer-events: none;&#92;n}&#92;n&#92;n.mt-bar-wrapper:hover::before {&#92;n  display: inline;&#92;n}&#92;n&#92;n.mt-bar-wrapper--left::before {&#92;n  left: 100%;&#92;n  border-top-left-radius: 0;&#92;n  border-bottom-left-radius: 0;&#92;n}&#92;n&#92;n.mt-bar-wrapper--right::before {&#92;n  right: 100%;&#92;n  border-top-right-radius: 0;&#92;n  border-bottom-right-radius: 0;&#92;n}&#92;n&#92;n/* Only when there&#39;s no hovered bar, show current bar and its tooltip */&#92;n.mt-chart:not(:has(.mt-bar-wrapper:hover)) {&#92;n  &amp; .mt-bar-wrapper--current {&#92;n    background-color: var(--mt-light-highlight);&#92;n  }&#92;n&#92;n  &amp; .mt-bar-wrapper--current .mt-bar {&#92;n    background-color: var(--mt-dark-highlight);&#92;n  }&#92;n&#92;n  &amp; .mt-bar-wrapper--current::before {&#92;n    display: inline;&#92;n  }&#92;n}&#92;n&#92;n.mt-yaxis-tick {&#92;n  border-top: 1px dashed lightgray;&#92;n  left: ${n};&#92;n  right: ${n};&#92;n  height: 0;&#92;n  position: absolute;&#92;n  z-index: 0;&#92;n}`,t.appendChild(r);const o=Math.max(...e.map((e=&gt;e.millis))),a=1.1*o;for(const e of function(e,t){const n=[];let r=t;for(;r&lt;e;)n.push(r),r+=t;return n}(o,3e4)){const n=document.createElement(&quot;div&quot;);n.classList.add(&quot;mt-yaxis-tick&quot;),n.style.bottom=String(e/a*100)+&quot;%&quot;,t.appendChild(n)}return e.forEach((n=&gt;{const r=document.createElement(&quot;div&quot;);r.classList.add(&quot;mt-bar&quot;),r.style.height=n.millis/a*100+&quot;%&quot;,r.style.setProperty(&quot;--mt-bar-color&quot;,&quot;black&quot;===n.color?&quot;black&quot;:&quot;white&quot;);const o=document.createElement(&quot;div&quot;);o.classList.add(&quot;mt-bar-wrapper&quot;,&quot;mt-bar-wrapper--&quot;+(n.move/e.length&lt;.5?&quot;left&quot;:&quot;right&quot;)),o.dataset.time=function(e){const t=e/1e3,n=e&gt;=1e3?Math.round(t):t;return n&lt;60?function(e){const t=e.toFixed(1);return(t.endsWith(&quot;.0&quot;)?t.slice(0,-2):t)+&quot;s&quot;}(n):function(e){const t=Math.trunc(e%60);return[Math.trunc(e/60)+&quot;m&quot;,0!==t?t+&quot;s&quot;:&quot;&quot;].filter((e=&gt;e)).join(&quot; &quot;)}(n)}(n.millis),o.dataset.move=n.move,o.appendChild(r),t.appendChild(o)})),{chart:t,markCurrentBar(e){const n=&quot;mt-bar-wrapper--current&quot;,r=t.querySelector(&quot;.&quot;+n);r&amp;&amp;r.classList.remove(n);const o=t.querySelector(`.mt-bar-wrapper[data-move=&quot;${e}&quot;]`);o&amp;&amp;o.classList.add(n)}}}const t=&quot;mt-widget&quot;;function n(e,t,n){e.remove();const r=&quot;before&quot;===t?&quot;beforebegin&quot;:&quot;afterend&quot;;n.insertAdjacentElement(r,e)}if(!(document.getElementsByClassName(t).length&gt;0))try{const r=function(e){const t=/https:&#92;/&#92;/online-go&#92;.com&#92;/game&#92;/(&#92;d+)/.exec(e),n=t?t[1]:null;if(!n)throw new Error(&quot;The move timing chart can only be loaded from OGS games.&#92;n&#92;nIf you&#39;re in a review, load the chart in game view first then return to the review.&quot;);return n}(window.location.toString()),{playerCards:o,actionBar:a,moveNumberContainer:i}=function(){const e=document.querySelector(&quot;div:has(&gt; .players)&quot;),t=document.querySelector(&quot;.action-bar&quot;),n=document.querySelector(&quot;.move-number&quot;);if(!e)throw new Error(&quot;Unable to find players: div:has(&gt; .players)&quot;);if(!t)throw new Error(&quot;Unable to find action bar: .action-bar&quot;);if(!n)throw new Error(&quot;Unable to find move number: .move-number&quot;);return{playerCards:e,actionBar:t,moveNumberContainer:n}}(),c=[],l=()=&gt;c.forEach((e=&gt;e())),s=!1,{toolbar:d,setToolbarActions:m}=function(e){let t=e;const n=document.createElement(&quot;div&quot;);n.style.display=&quot;flex&quot;,n.style.gap=&quot;0.4rem&quot;,n.style.flex=&quot;0 0 auto&quot;;const r=(e,t)=&gt;{const n=document.createElement(&quot;button&quot;);return n.id=e,n.textContent=t,n},o=r(&quot;mt-hide&quot;,&quot;Hide&quot;);n.appendChild(o);const a=r(&quot;mt-toggle&quot;,t?&quot;Collapse&quot;:&quot;Expand&quot;);return n.appendChild(a),{toolbar:n,setToolbarActions(e){o.addEventListener(&quot;click&quot;,e.onHide),a.addEventListener(&quot;click&quot;,(()=&gt;{t?(e.onCollapse(),a.textContent=&quot;Expand&quot;):(e.onExpand(),a.textContent=&quot;Collapse&quot;),t=!t}))}}}(s),{content:h,widget:p,tearDownWidget:u}=function(e){const n=document.createElement(&quot;div&quot;);n.classList.add(t),n.style.display=&quot;flex&quot;,n.style.flexDirection=&quot;column&quot;,n.style.paddingBlock=&quot;1rem&quot;,n.style.gap=&quot;0.5rem&quot;,n.style.boxSizing=&quot;border-box&quot;,n.style.flex=&quot;1 0 12rem&quot;;const r=document.createElement(&quot;div&quot;);return r.style.flex=&quot;1 1 100%&quot;,n.appendChild(e),n.appendChild(r),{widget:n,content:r,tearDownWidget(){n.remove()}}}(d);c.push(u);const b=()=&gt;n(p,&quot;after&quot;,o);m({onHide:l,onExpand:()=&gt;n(p,&quot;before&quot;,a),onCollapse:b}),s||b(),h.replaceChildren(&quot;Loading...&quot;),function(e){return fetch(function(e){return`https://online-go.com/api/v1/games/${e}`}(e)).then((e=&gt;e.json()))}(r).then((t=&gt;{const n=function(e){const t=&quot;black&quot;===e.gamedata.initial_player,n=t?&quot;black&quot;:&quot;white&quot;,r=t?&quot;white&quot;:&quot;black&quot;;return e.gamedata.moves.map(((e,t)=&gt;{const o=t+1;var a;return{move:o,color:(a=o,a%2==1?n:r),millis:e[2]}}))}(t),{chart:r,markCurrentBar:o}=e(n);h.replaceChildren(r);const a=function(e,t){const n=e=&gt;{const n=e.split(&quot;&quot;).filter((e=&gt;e.match(/&#92;d/))).join(&quot;&quot;);n&amp;&amp;t(Number(n))};n(e.textContent);const r=new MutationObserver((e=&gt;{e.filter((e=&gt;&quot;characterData&quot;===e.type)).forEach((e=&gt;n(e.target.data)))}));return r.observe(e,{characterData:!0,subtree:!0}),()=&gt;r.disconnect()}(i,(e=&gt;o(e)));c.push(a)})).catch((e=&gt;console.error(e)))}catch(e){console.error(e),alert(&quot;Error: &quot;+e.message)}})();
">ogs-move-timing</a></p>
<h2>Usage</h2>
<ol>
<li>Open a (finished) game on <a href="https://online-go.com/">OGS</a>.</li>
<li>Click the bookmark you made during the Installation step.</li>
<li>A bar chart will appear in the right sidebar.
<ul>
<li>It displays the time spent on each move and highlights the move currently shown on the board.</li>
<li>Clicking a bar in the chart jumps to that move.</li>
<li>Hovering over the chart also does something.</li>
</ul>
</li>
<li>There is a &quot;Hide&quot; button above the chart. Click that when done.</li>
</ol>
<h2>Changelog</h2>
<p>Notable changes will be listed here.</p>
<h3>April 3, 2024</h3>
<ul>
<li>User can click a bar in the timing chart to change the board start to that move.</li>
</ul>
<h3>March 25, 2024</h3>
<ul>
<li>Timing chart now appears in sidebar by default, with &quot;Expand&quot; button to pop it out under the goban.</li>
</ul>
<h2>Source code</h2>
<p>https://github.com/psalaets/ogs-move-timing</p>

  </main>
</body>
</html>
