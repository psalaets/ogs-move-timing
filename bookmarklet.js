function t(t){const e=t/1e3,n=t>=1e3?Math.round(e):e;return n<60?function(t){const e=t.toFixed(1);return(e.endsWith(".0")?e.slice(0,-2):e)+"s"}(n):function(t){const e=Math.trunc(t%60);return[Math.trunc(t/60)+"m",0!==e?e+"s":""].filter((t=>t)).join(" ")}(n)}if(!(document.getElementsByClassName("mt-widget").length>0))try{const e=function(t){const e=/https:\/\/online-go\.com\/(game|review)\/(\d+)/.exec(t),n=e?e[2]:null;if(!n)throw new Error("This only works on OGS games and OGS game reviews");return n}(window.location.toString()),{actionBar:n,moveNumberContainer:r}=function(){const t=document.querySelector(".action-bar"),e=document.querySelector(".move-number");if(!t)throw new Error("Unable to find action bar (.action-bar)");if(!e)throw new Error("Unable to find move number (.move-number)");return{actionBar:t,moveNumberContainer:e}}(),o=[],a=()=>o.forEach((t=>t())),{content:i,widget:c,attachToDom:l}=function(t){const e=document.createElement("div");e.classList.add("mt-widget"),e.style.display="flex",e.style.flexDirection="column",e.style.padding="1rem",e.style.gap="0.5rem",e.style.boxSizing="border-box",e.style.flex="1 0 16rem";const n=document.createElement("div");return n.style.flex="1 1 100%",e.appendChild(t),e.appendChild(n),{widget:e,content:n,attachToDom(t){t.parentElement.insertBefore(e,t)}}}(function(t){const e=document.createElement("div");return e.style.flex="0 0 auto",e.innerHTML='<button id="mt-hide">Hide</button>',e.addEventListener("click",(e=>{e.target instanceof HTMLButtonElement&&"mt-hide"===e.target.id&&t()})),e}(a));l(n),o.push((()=>c.remove())),i.replaceChildren("Loading..."),function(t){return fetch(function(t){return`https://online-go.com/api/v1/games/${t}`}(t)).then((t=>t.json()))}(e).then((e=>{const n=function(t){const e="black"===t.gamedata.initial_player,n=e?"black":"white",r=e?"white":"black";return t.gamedata.moves.map(((t,e)=>{const o=e+1;var a;return{move:o,color:(a=o,a%2==1?n:r),millis:t[2]}}))}(e);(function(e,n){const r=document.createElement("div");r.classList.add("mt-chart");const o="1rem",a=document.createElement("style");a.textContent=`\n.mt-chart, .mt-chart * {\n  box-sizing: border-box;\n}\n\n.mt-chart {\n  display: flex;\n  position: relative;\n  background-color: darkgray;\n  min-height: 100%;\n  cursor: crosshair;\n  padding-inline: ${o};\n\n  --mt-dark-highlight: #ffd800;\n  --mt-light-highlight: yellow;\n}\n\n.mt-bar {\n  flex: 1 1 100%;\n  background-color: var(--mt-bar-color);\n}\n\n.mt-bar-wrapper {\n  min-height: 100%;\n  position: relative;\n  display: flex;\n  align-items: flex-end;\n  flex: 1 0 3px;\n}\n\n.mt-bar-wrapper:hover {\n  background-color: var(--mt-light-highlight);\n}\n\n.mt-bar-wrapper:hover .mt-bar {\n  background-color: var(--mt-dark-highlight);\n}\n\n.mt-bar-wrapper::before {\n  display: none;\n  position: absolute;\n  content: attr(data-time) ' on move ' attr(data-move);\n  top: 0px;\n  min-width: 10rem;\n  padding: 0.2rem;\n  background-color: white;\n  border-radius: 5px;\n  z-index: 1;\n  text-align: center;\n  pointer-events: none;\n}\n\n.mt-bar-wrapper:hover::before {\n  display: inline;\n}\n\n.mt-bar-wrapper--left::before {\n  left: 0;\n}\n\n.mt-bar-wrapper--right::before {\n  right: 0;\n}\n\n/* Only when there's no hovered bar, show current bar and its tooltip */\n.mt-chart:not(:has(.mt-bar-wrapper:hover)) {\n  & .mt-bar-wrapper--current {\n    background-color: var(--mt-light-highlight);\n  }\n\n  & .mt-bar-wrapper--current .mt-bar {\n    background-color: var(--mt-dark-highlight);\n  }\n\n  & .mt-bar-wrapper--current::before {\n    display: inline;\n  }\n}\n\n.mt-yaxis-tick {\n  border-top: 1px dashed lightgray;\n  left: ${o};\n  right: ${o};\n  height: 0;\n  position: absolute;\n  z-index: 0;\n}`,r.appendChild(a);const i=Math.max(...n.map((t=>t.millis))),c=1.1*i;for(const t of function(t,e){const n=[];let r=e;for(;r<t;)n.push(r),r+=e;return n}(i,3e4)){const e=document.createElement("div");e.classList.add("mt-yaxis-tick"),e.style.bottom=String(t/c*100)+"%",r.appendChild(e)}n.forEach((e=>{const o=document.createElement("div");o.classList.add("mt-bar"),o.style.height=e.millis/c*100+"%",o.style.setProperty("--mt-bar-color","black"===e.color?"black":"white");const a=document.createElement("div");a.classList.add("mt-bar-wrapper","mt-bar-wrapper--"+(e.move/n.length<.5?"left":"right")),a.dataset.time=t(e.millis),a.dataset.move=e.move,a.appendChild(o),r.appendChild(a)})),e.replaceChildren(r)})(i,n);const a=function(t,e){const n=t=>{const n=t.split("").filter((t=>t.match(/\d/))).join("");n&&e(Number(n))};n(t.textContent);const r=new MutationObserver((t=>{t.filter((t=>"characterData"===t.type)).forEach((t=>n(t.target.data)))}));return r.observe(t,{characterData:!0,subtree:!0}),()=>r.disconnect()}(r,(t=>function(t){const e="mt-bar-wrapper--current",n=document.querySelector("."+e);n&&n.classList.remove(e);const r=document.querySelector(`.mt-bar-wrapper[data-move="${t}"]`);r&&r.classList.add(e)}(t)));o.push(a)})).catch((t=>console.error(t)))}catch(t){console.error(t),alert("Error: "+t.message)}
